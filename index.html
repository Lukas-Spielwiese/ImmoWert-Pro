<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ImmoWertPro – Professioneller Gutachten‑Generator</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Professioneller Verkehrswertgutachten‑Generator</h1>

  <form id="gutachtenForm">
    <!-- Abschnitt: Grunddaten zum Objekt -->
    <fieldset>
      <legend>1&nbsp;–&nbsp;Basisdaten</legend>
      <div class="grid">
        <label>
          Objektnummer (ONR)
          <input type="text" id="onr" placeholder="z. B. ONR‑2025‑XYZ‑0001" required>
        </label>
        <label>
          Gebäudeart
          <select id="buildingType" required>
            <option value="single">Freistehendes Einfamilienhaus</option>
            <option value="double">Doppelhaus / Reihenendhaus</option>
            <option value="row">Reihenmittelhaus</option>
            <option value="multi_small">Mehrfamilienhaus (bis 6 WE)</option>
            <option value="multi_medium">Mehrfamilienhaus (7–20 WE)</option>
            <option value="multi_large">Mehrfamilienhaus (&gt;20 WE)</option>
          </select>
        </label>
        <label>
          Standardstufe
          <select id="standardLevel" required>
            <option value="1">1 – unzeitgemäß</option>
            <option value="2">2 – einfach</option>
            <option value="3" selected>3 – mittel</option>
            <option value="4">4 – gehoben</option>
            <option value="5">5 – stark gehoben</option>
          </select>
        </label>
        <label>
          Baujahr des Gebäudes
          <input type="number" id="constructionYear" min="1800" max="2100" step="1" placeholder="z. B. 1990" required>
        </label>
        <label>
          Übliche Gesamtnutzungsdauer (Jahre)
          <input type="number" id="gnd" min="30" max="100" step="1" placeholder="z. B. 80" required>
        </label>
        <label>
          Brutto‑Grundfläche BGF (m²)
          <input type="number" id="bgf" min="1" step="0.1" placeholder="z. B. 180" required>
        </label>
        <label>
          Grundstücksfläche (m²)
          <input type="number" id="landArea" min="1" step="0.1" placeholder="z. B. 600" required>
        </label>
      </div>
      <label>
        Nutzung des Objekts / Gebäudeart
        <input type="text" id="nutzung" placeholder="z. B. EFH, MFH, Büro …">
      </label>
      <label>
        Lagebeschreibung (Kurzbeschreibung)
        <textarea id="lage" rows="2" placeholder="freie Beschreibung der Lage, Umgebung, Infrastruktur …"></textarea>
      </label>
      <label>
        Rechte und Lasten
        <textarea id="rechte" rows="2" placeholder="Dienstbarkeiten, Baulasten, Wegerechte …"></textarea>
      </label>
      <label>
        Besonderheiten / Objektbeschreibung
        <textarea id="besonderheiten" rows="3" placeholder="Ausführliche Objektbeschreibung, bauliche Besonderheiten, Schäden …"></textarea>
      </label>
    </fieldset>

    <!-- Abschnitt: Modernisierung -->
    <fieldset>
      <legend>2&nbsp;–&nbsp;Modernisierung (Punktetabelle)</legend>
      <p>Markieren Sie die bereits durchgeführten Modernisierungsmaßnahmen. Die Punkte orientieren sich an Anlage 4 SW‑RL【431491009068357†L2907-L2933】.</p>
      <div class="modernisation-list">
        <label><input type="checkbox" class="mod-item" data-points="4"> Dacherneuerung inkl. Wärmedämmung (4 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Modernisierung Fenster/Außentüren (2 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Modernisierung Leitungssysteme (Strom, Gas, Wasser, Abwasser) (2 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Modernisierung Heizungsanlage (2 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="4"> Wärmedämmung Außenwände (4 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Modernisierung Bäder (2 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Modernisierung Innenausbau (Decken, Fußböden, Treppen) (2 Punkte)</label>
        <label><input type="checkbox" class="mod-item" data-points="2"> Wesentliche Grundrissverbesserung (2 Punkte)</label>
      </div>
      <div id="modPointsDisplay">Modernisierungspunkte: 0 (nicht modernisiert)</div>
    </fieldset>

    <!-- Abschnitt: Wertrelevante Datenquellen -->
    <fieldset>
      <legend>3&nbsp;–&nbsp;Datenquellen &amp; Parameter</legend>
      <div class="grid">
        <label>
          Bodenrichtwertzone
          <input type="text" id="brwZone" placeholder="z. B. HV-123-456">
        </label>
        <label>
          Bodenrichtwert (€/m²)
          <input type="number" id="brwValue" min="0" step="0.01" placeholder="z. B. 450" required>
        </label>
        <label>
          Liegenschaftszinssatz (% p.a.)
          <input type="number" id="lz" min="0" step="0.01" placeholder="z. B. 3.5">
        </label>
        <label>
          Baupreisindex (Stand = 100 für 2010)
          <input type="number" id="bpi" min="50" max="300" step="0.1" placeholder="z. B. 141" required>
        </label>
        <label>
          Regionalfaktor (ortsabhängig)
          <input type="number" id="regionalFactor" min="0.5" max="2" step="0.01" value="1" required>
        </label>
        <label>
          Marktanpassungsfaktor (Sachwertfaktor)
          <input type="number" id="marketFactor" min="0.5" max="2" step="0.01" value="1" required>
        </label>
      </div>
      <p>Hinweis: Der Baupreisindex wird benötigt, um die NHK 2010 auf den Preisstand des Wertermittlungsstichtages hochzurechnen【559551144243427†L422-L445】. Regionale Faktoren können Sie bei Ihrem Gutachterausschuss erfragen.</p>
    </fieldset>

    <!-- Abschnitt: Mieteinnahmen (Ertragswert) -->
    <fieldset>
      <legend>4&nbsp;–&nbsp;Mieteinnahmen (Ertragswertverfahren)</legend>
      <p>Fügen Sie die einzelnen Einheiten mit Mietfläche und monatlicher Miete je m² hinzu. Bei leerstehenden Objekten lassen Sie die Liste leer.</p>
      <table id="rentTable">
        <thead>
          <tr><th>Fläche (m²)</th><th>Kaltmiete (€/m²&nbsp;monatlich)</th><th></th></tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      <button type="button" id="addRent">Einheit hinzufügen</button>
      <label>
        Bewirtschaftungskosten (% vom Rohertrag)
        <input type="number" id="maintCostPercent" min="0" max="50" step="0.1" value="20">
      </label>
      <label>
        Freitext Ertragswertverfahren
        <textarea id="ertragsText" rows="2" placeholder="Begründungen, besondere vertragliche Regelungen, etc."></textarea>
      </label>
    </fieldset>

    <!-- Abschnitt: Vergleichswerte -->
    <fieldset>
      <legend>5&nbsp;–&nbsp;Vergleichswerte</legend>
      <p>Tragen Sie hier Vergleichskaufpreise ein. Geben Sie den Gesamtpreis je Vergleichsobjekt an. Die Gewichtung dient der Einflussstärke im arithmetischen Mittel.</p>
      <table id="compTable">
        <thead>
          <tr><th>Preis (€)</th><th>Gewichtung (%)</th><th></th></tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      <button type="button" id="addComp">Vergleich hinzufügen</button>
      <label>
        Freitext Vergleichswertverfahren
        <textarea id="vergleichText" rows="2" placeholder="Herleitung der Vergleiche, Abweichungen, etc."></textarea>
      </label>
    </fieldset>

    <!-- Abschnitt: Zusätzliche Notizen -->
    <fieldset>
      <legend>6&nbsp;–&nbsp;Zusätzliche Notizen &amp; Begründungen</legend>
      <label>
        Bemerkungen / Notizen
        <textarea id="notes" rows="3" placeholder="Zusätzliche Hinweise, besondere objektspezifische Grundstücksmerkmale, etc."></textarea>
      </label>
      <label>
        Freitext Sachwertverfahren
        <textarea id="sachwertText" rows="2" placeholder="Begründungen für Parameterwahl, besondere Korrekturen, etc."></textarea>
      </label>
    </fieldset>

    <!-- Abschnitt: Anlagen / Bilder -->
    <fieldset>
      <legend>7&nbsp;–&nbsp;Bilder und Anhänge</legend>
      <p>Sie können Fotos oder Pläne hochladen. Diese werden im Export im Ordner <code>attachments/</code> gespeichert. Das DOCX listet die Dateinamen, eine automatische Einbettung erfolgt nicht.</p>
      <input type="file" id="attachments" multiple accept="image/*">
    </fieldset>

    <!-- Abschnitt: Steuerung -->
    <fieldset class="actions">
      <legend>8&nbsp;–&nbsp;Berechnung &amp; Export</legend>
      <label>
        Manuell festgelegter Verkehrswert (€)
        <input type="number" id="manualValue" min="0" step="0.01" placeholder="optional – überschreibt Berechnung">
      </label>
      <div class="button-row">
        <button type="button" id="calculateBtn">Berechnung durchführen</button>
        <button type="button" id="exportBtn">Exportieren (JSON + DOCX)</button>
        <label class="import-label">
          Importieren
          <input type="file" id="importFile" accept="application/zip">
        </label>
      </div>
    </fieldset>
  </form>

  <!-- Ergebnisanzeige -->
  <section id="results" class="results"></section>

  <script src="jszip.min.js"></script>
  <script src="docxGenerator.js"></script>
  <script src="script.js"></script>
</body>
</html>